<!doctype html>
<html lang="zxx">

<head>
    <!-- metas -->
    <meta charset="utf-8">
    <meta name="author" content="pxdraft">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="keywords" content="ShopApp - eCommerce Bootstrap 5 Template">
    <meta name="description" content="ShopApp - eCommerce Bootstrap 5 Template">
    <!-- title -->
    <title>租借品專區 - 租借須知</title>
    <!-- Favicon -->
    <link rel="shortcut icon" th:href="@{/logo/favicon.ico}">
    <!-- CSS Template -->
    <link th:href="@{/frontend/assets/css/style.css}" rel="stylesheet">


    <style>

        span.successMsg {
            /* 確保初始狀態為隱藏，以便fadeIn能正常工作 */
            display: none;
        }

    </style>


</head>

<body>
<!-- 通用插件 -->
<th:block th:replace="frontend/component/plugin/frontendplugin :: components"></th:block>
<!-- 通用插件 -->
<!--
========================
    Wrapper
========================
-->
<div class="wrapper">
    <!-- header height -->
    <div class="header-height-bar" style="min-height: 144.865px;"></div>
    <!-- Header -->
    <header th:replace="frontend/component/header :: header"></header>
    <!-- End Header -->
    <!-- Main -->
    <main>
        <!-- 租借品專區 - 租借須知 -->
        <div class="py-3 bg-gray-100">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-6 my-2">
                        <h1 class="m-0 h4 text-center text-lg-start">租借須知</h1>
                    </div>
                    <div class="col-lg-6 my-2">
                        <ol class="breadcrumb m-0 small justify-content-center justify-content-lg-end">
                            <li class="breadcrumb-item">
                                <a class="text-nowrap text-reset" th:href="@{/frontend/index}">Home</a>
                            </li>
                            <li class="breadcrumb-item text-nowrap active" aria-current="page">租借須知</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Breadcrumb -->
        <!-- Shop -->
        <section class="py-6">
            <div class="container">
                <div class="row">
                    <!-- 側邊攔 -->
                    <div class="col-lg-4 col-xl-3 pe-xl-5 offcanvas-lg offcanvas-start px-0 px-lg-3" tabindex="-1"
                         id="shop_filter" aria-labelledby="shop_filterLabel">
                        <div class="offcanvas-header border-bottom">
                            <h5 class="offcanvas-title" id="shop_filterLabel">Shop Filter</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
                                    data-bs-target="#shop_filter" aria-label="Close">
                            </button>
                        </div>
                        <div class="offcanvas-body flex-column">
                            <!-- Categories -->
                            <div class="shop-sidebar-block">
                                <div class="shop-sidebar-title">
                                    <a class="h5" data-bs-toggle="collapse" href="#shop_categories" role="button"
                                       aria-expanded="true" aria-controls="shop_categories">
                                        租借須知 <i class="bi bi-chevron-up"></i>
                                    </a>
                                </div>
                                <div class="shop-category-list collapse show" id="shop_categories">
                                    <ul class="nav flex-column">
                                        <li class="nav-item">
                                            <a th:href="@{/frontend/rental/rentalInstructions}" class="nav-link active">租借詳情</a>
                                        </li>
                                        <li class="nav-item">
                                            <a th:href="@{/frontend/rental/rentalInstructionsSend}" class="nav-link active">運送方式</a>
                                        </li>
                                        <li class="nav-item">
                                            <a th:href="@{/frontend/rental/rentalInstructionsSize}" class="nav-link active">尺寸表</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div><!-- End Sidebar -->
                    <!-- 商品列表 -->
                    <div class="col-lg-8 col-xl-9">
                        <div class="shop-top-bar d-flex pb-3">
                            <!-- 文章列表 -->
                            <section class="col-sm-12 col-md-9">
                                <div class="left-align">
                                    <span style="font-family:Arial,Helvetica,sans-serif">
                                        <span style="color:#ff0000">
                                            <strong><span style="font-size:22px">營業時間</span></strong> <!-- 標題 -->
                                        </span><br><br>
                                        <span style="font-size:16px">
                                            <strong>★ 每週一至週六   早上 11 : 00 ~ 下午 9 : 00</strong>
                                        </span>
                                        <span style="font-family:Arial,Helvetica,sans-serif">
                                            <span style="font-size:16px">（國定假日則另行公告）</span>
                                        </span>
                                    </span>
                                </div>
                                <p class="left-align">＊營業時間會隨淡/旺季更改，有疑問可來電詢問</p>
                                <hr/>
                                <div class="left-align">
                                    <span style="font-family:Arial,Helvetica,sans-serif">
                                        <span style="color:#ff0000">
                                            <strong><span style="font-size:22px">租借流程</span></strong><!-- 標題 -->
                                        </span><br><br>
                                        <span style="font-size:16px">1. 於官網挑選服裝</span><br>
                                        <span style="font-size:16px">2. 將您想預約的服裝加入購物車
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;(若暫無庫存，可以先將喜愛之商品點選「追蹤」，若有庫存會及時通知。)</span><br>
                                        <span style="font-size:16px">3. 確認租借日期、金額與配送方式</span><br>
                                        <span style="font-size:16px">4. 付款完成後，官方安排配送程序
                                              (依據商品寄出日期開始計算使用天數)</span><br>
                                        <span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;★ 租借天數：借1件（租7天）、借2件以上(租14天)</span><br>
                                        <span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;★ 運費金額：NT$100</span><br>
                                        <span style="font-size:16px">5. 於歸還日前寄回該商品，即完成訂單</span><br>
                                        <hr/>
                                        <span style="font-size:22px">
                                            <strong><span style="color:#ff0000">租借需知</span></strong><!-- 標題 -->
                                        </span><br><br>
                                        <span style="font-size:16px"><strong>★ 租借押金：</strong>(1) 小禮服 -> 押金NT$2000
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2) 西裝、婚紗 -> 押金NT$4000</span><br>
                                        <span style="font-size:16px"><strong>★ 租借天數：</strong>借1件（租7天）、2件以上 (租14天)</span><br>
                                        <span style="font-size:16px"><strong>★ 追蹤品項：</strong>
                                              若想租借品項暫無庫存，可將欲租借但尚無庫存之租借品加入追蹤清單，
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;亦可選擇期望租借日，待品項上架後，會訊息通知。
                                        </span><br>
                                        <span style="font-size:16px"><strong>★ 歸還規則：</strong>
                                              (1) 在預計時間內歸還，押金全數歸還
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                              (2) 延遲1天，押金扣50%
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                              (3) 延遲2天(含2天以上)，押金不歸還
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                              (4) 歸還的最後一天為客戶寄出當天
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                              (5) 歸還前3天會發送mail提醒歸還
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                              (6) 若中途有換貨，"預計歸還時間" 依照原本訂單的歸還日</span><br>
                                        <span style="font-size:16px"><strong>★ 退換貨規則：</strong>
                                              (1) 只能換貨一次，需酌收 NT$200手續費
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                              (2) 若需換貨，僅提供尺寸工換，不可換顏色
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(僅提供1次換貨，並會酌收 NT$200手續費)
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                              (3) 若需更換顏色，須走退貨流程 (詳細請與客服聯繫)
                                        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                              (4) 若下單多筆品項想單一更換的話，須走退貨流程</span><br><br>
                                        <span style="font-size:16px">★ 租借之服裝並非量身訂製亦非全然是全新商品，可參考各種款式之尺碼對照表，
                                            <br>&nbsp;&nbsp;&nbsp;&nbsp;選擇符合您身型的尺碼讓服裝穿起來較合身，但不保證百分之百符合顧客的尺寸，
                                            <br>&nbsp;&nbsp;&nbsp;&nbsp;若有特殊需求請與門市服務人員洽詢。</span><br>
                                        <span style="font-size:16px">★ 租用服裝若必須自行修改者，嚴禁使用釘書機(針)、雙面膠、膠類等加工服裝，
                                            <br>&nbsp;&nbsp;&nbsp;&nbsp;請使用針線或別針做任何加工修改，使用完後請恢復原狀再做歸還。如汙損或遺失，
                                            <br>&nbsp;&nbsp;&nbsp;&nbsp;必須賠償修補或整洗與之費用和等同天數的租金，客戶不得異議。</span><br>
                                        <span style="font-size:16px">★ 已完成訂單者，因可歸責付定金人之事由，
                                            致不能履行時，不得請求返還定金。</span><br>
                                        <span style="font-size:16px">★ 請勿侵佔租賃之服裝與道具，謊報少寄或已寄還，
                                            以免觸犯侵佔罪及詐欺罪，<br>&nbsp;&nbsp;&nbsp;&nbsp;依法判五年以下有期徒刑。
                                            請客戶自重~勿觸法！</span>
                                    </span>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- End Shop -->
    </main>
    <!-- End Main -->
    <!-- Footer -->
    <footer th:replace="frontend/component/footer :: footer"></footer>
    <!-- End Footer -->
</div>
<!--
========================
   End Wrapper
========================
-->
<!-- script start -->
<th:block th:insert="~{frontend/component/plugin/frontendplugin.html :: js}"></th:block>
<!-- End script start -->

<script>

    /*----------------------------右翰寫的方法----------------------------------*/

    $(function () {

        let baseUrl = window.location.protocol + "//" + window.location.host;
        let rentalAllPrice = 0;
        let rentalAllDepPrice = 0;

        function getAll() {

            // items.length = 0;
            rentalAllPrice = 0;
            rentalAllDepPrice = 0;
            let apiPath = "/backend/rentalorder/";
            let memNo = 1;

            fetch(baseUrl + apiPath + "getFromCart?memNo=" + memNo)
                .then(function (response) {
                    return response.json();
                }).then(function (data) {

                let itemContainer = $("ul.list-unstyled");
                // console.log(itemContainer);
                // 每次更新前清空，放購物車資訊的 ul
                itemContainer.empty();

                let totalItems = Object.keys(data).length; // 計算購物車商品數量
                $("span[data-cart-items]").attr("data-cart-items", totalItems); // 更新購物車商品數量圖示

                /*
                 * 遍歷陣列裡每個元素，每個元素都是一對 key, item，以下舉例 :
                 * [陣列1, 陣列2]
                 * 陣列1 => ["member : 1 : cartItem : 5011", {rentalCatNo : "5", rentalColor : "深卡其色"...}]
                */
                Object.entries(data).forEach(([key, item]) => {

                    // if (item.rentalStat === "0") {
                    //     items.push(item.rentalNo);
                    // }

                    // 拼接首頁購物車區塊小明細
                    if (item.rentalStat === "0") {

                        let cartItem = $("<li>", {
                            "class" : "py-2"
                        }).appendTo(itemContainer);
                        let firstDiv = $("<div>", {
                            "class" : "row align-items-center"
                        }).appendTo(cartItem);
                        let aDiv = $("<div>", {
                            "class" : "col-4"
                        }).appendTo(firstDiv);
                        let aForItemImage = $("<a>", {
                            "href" : "#"
                        }).appendTo(aDiv);
                        let itemImage = $("<img>", {
                            "class" : "img-fluid border",
                            "th:src" : "@{/frontend/assets/img/fashion/product-x-1.jpg}",
                            "alt" : "..."
                        }).appendTo(aForItemImage);
                        let divForInfo = $("<div>", {
                            "class" : "col-8"
                        }).appendTo(firstDiv);


                        /*
                         <ul class="list-unstyled m-0 p-0">
                            <li class="py-2">
                                <div class="row align-items-center">
                                    <div class="col-4"> adiv
                                        <!-- Image -->
                                        <a href="#"> aForItemImage
                                            <img class="img-fluid border" th:src="@{/frontend/assets/img/fashion/product-x-1.jpg}" alt="...">
                                        </a>
                                    </div>
                                    <div class="col-8"> divForInfo
                                        <!-- Title -->
                                        <p class="mb-2">
                                            <a class="text-mode fw-500" href="#">這裡是品名</a>
                                            <span class="m-0 text-muted w-100 d-block">這裡是價格</span>
                                        </p>
                                        <!--Footer -->
                                        <div class="d-flex align-items-center">
                                            <!-- Remove -->
                                            <a class="small text-mode ms-auto" href="#!">
                                                <i class="bi bi-x"></i> Remove
                                            </a>
                                        </div>
                                    </div> // div col-8 結束
                                </div>
                            </li>
                         */

                        rentalAllPrice += parseFloat(item.rentalPrice);
                        rentalAllDepPrice += parseFloat(item.rentalDesPrice);

                    }

                });

                // console.log(items);
                $("span.rentalAllPrice").text(rentalAllPrice);
                $("span.rentalAllDepPrice").text(rentalAllDepPrice);
                $("span.totalPrice").text( (rentalAllPrice + rentalAllDepPrice) );

            });

        } // getAll()結束
        // 進來頁面就先取一次
        getAll();

        // 加入購物車 339
        $(document).on("click", "a.btn_addToCart", function (e) {

            e.preventDefault();
            /*
             * 拼接動態前置路徑 (為適應上雲時路徑變化)
             * window.location.protocol = 當前頁面所使用之通訊協定 (ex : http: 、 https:)
             * window.location.host = 當前頁面主機名和連接阜號 (ex : localhost:8080)
            */
            let apiPath = "/backend/rentalorder/setToCart";
            let $this = $(this);
            // span.rentalNo
            let rentalNo = $this.closest("div.rental").find("span.rentalNo").text().trim();
            let memNo = 1;

            let data = {
                "rentalNo" : rentalNo,
                "memNo" : memNo
            };

            fetch(baseUrl + apiPath, {
                method : "POST",
                headers : {
                    "Content-Type" : "application/json"
                },
                body : JSON.stringify(data)
            }).then(function (response) {
                // console.log(response)
                return response.text();
            }).then(function (rentalName) {
                // console.log(rentalName);
                // console.log(this);
                $this.closest("div.rental").find("span.successMsg").text("已將" + rentalName + "加入購物車!").fadeIn(0).delay(500).fadeOut(500);
            })

        }); // 加入購物車方法結束

    }); // DOMContentLoaded 結束

    /*----------------------------右翰寫的方法----------------------------------*/

</script>
<script th:src="@{/jquery/jquery-3.7.1.min.js}"></script>
</body>
</html>