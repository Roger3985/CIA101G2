<!DOCTYPE html>
<html lang="zxx" data-bs-theme="light">

<head><!-- metas -->
    <meta charset="utf-8">
    <meta name="author" content="pxdraft">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="keywords" content="ShopApp - eCommerce Bootstrap 5 Template">
    <meta name="description" content="ShopApp - eCommerce Bootstrap 5 Template">
    <!-- title -->
    <title>ShopApp - eCommerce Bootstrap 5 Template</title>
    <!-- Favicon -->
    <link rel="shortcut icon" th:href="@{/logo/favicon.ico}">
    <!-- CSS Template -->
    <link th:href="@{/frontend/assets/css/style.css}" rel="stylesheet">
</head>

<body>
<!-- 通用插件 -->
<th:block th:replace="frontend/component/plugin/frontendplugin :: components"></th:block>
<!-- 通用插件 -->
<!--
========================
    Wrapper
========================
-->
<div class="wrapper">
    <!-- header height -->
    <div class="header-height-bar" style="min-height: 104.865px;"></div>
    <!-- Header -->
    <header th:replace="frontend/component/header :: header"></header>
    <!-- End Header -->
    <!-- Main -->
    <main>
        <!-- Breadcrumb -->
        <div class="py-3 bg-gray-100">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-6 my-2">
                        <h1 class="m-0 h4 text-center text-lg-start">付款頁面</h1>
                    </div>
                    <div class="col-lg-6 my-2">
                        <ol class="breadcrumb dark-link m-0 small justify-content-center justify-content-lg-end">
                            <li class="breadcrumb-item"><a class="text-nowrap" href="#"><i
                                    class="bi bi-home"></i>首頁</a></li>
                            <li class="breadcrumb-item text-nowrap active" aria-current="page">付款頁面</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div><!-- End Breadcrumb --><!-- Table -->
        <div class="py-6">
            <div class="container">
                <div class="row"><!-- Profile Menu -->
                    <div class="col-lg-4 pb-4 pb-lg-0 col-xxl-3 pe-xxl-5">
                        <div class="bg-body border border-bottom-0 shadow-lg">
                            <div class="d-flex p-3 align-items-center">
                                <div class="avatar avatar-lg rounded-circle"><img
                                        src="../../assets/img/avatar/avatar-2.jpg" title="" alt=""></div>
                                <div class="col ps-3">
                                    <h6 class="m-0">Jennifer Winget</h6><small><a
                                        href="#">your@email.com</a></small>
                                </div>
                            </div>
                            <div class="bg-gray-200 p-3 border-bottom border-top">
                                <h6 class="m-0">Dashboard</h6>
                            </div>
                            <ul class="list-unstyled mb-0 theme-link">
                                <li class="border-bottom mb-0"><a
                                        class="nav-link-style d-flex align-items-center p-3"
                                        href="account-order.html"><i class="bi bi-bag me-2"></i> Order
                                    <div class="ms-auto badge-pill badge bg-secondary">5</div>
                                </a></li>
                                <li class="border-bottom mb-0"><a
                                        class="nav-link-style d-flex align-items-center p-3"
                                        href="account-wishlist.html"><i class="fi-heart me-2"></i>Wishlist
                                    <div class="ms-auto badge-pill badge bg-secondary">5</div>
                                </a></li>
                                <li class="border-bottom mb-0"><a
                                        class="nav-link-style d-flex align-items-center p-3"
                                        href="account-tickets.html"><i class="bi bi-bookmark me-2"></i>Support
                                    Tickets
                                    <div class="ms-auto badge-pill badge bg-secondary">0</div>
                                </a></li>
                            </ul>
                            <div class="bg-gray-200 p-3 border-bottom">
                                <h6 class="m-0">Account settings</h6>
                            </div>
                            <ul class="list-unstyled mb-0 theme-link">
                                <li class="border-bottom mb-0"><a
                                        class="nav-link-style d-flex align-items-center p-3"
                                        href="account-profile.html"><i class="fi-user me-2"></i>Profile info</a>
                                </li>
                                <li class="border-bottom mb-0"><a
                                        class="nav-link-style d-flex align-items-center p-3"
                                        href="account-address.html"><i class="bi bi-map-fill me-2"></i>Addresses</a>
                                </li>
                                <li class="border-bottom mb-0"><a
                                        class="nav-link-style d-flex align-items-center active p-3"
                                        href="account-payment.html"><i
                                        class="bi bi-credit-card me-2"></i>Payment</a>
                                </li>
                                <li class="border-bottom mb-0"><a
                                        class="nav-link-style d-flex align-items-center p-3" href="#"><i
                                        class="bi bi-box-arrow-left me-2"></i>Logout</a>
                                </li>
                            </ul>
                        </div>
                    </div><!-- End Profile Menu --><!-- Content -->
                    <div class="col-lg-8 col-xxl-9">
                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header py-3 d-flex align-items-center">
                                        <h6 class="m-0">Visa
                                            Card</h6><span class="ms-auto"><img width="40"
                                                                                src="../../assets/img/flags/card-visa.png" title="" alt=""></span>
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-12"><span class="small letter-spacing-2">CARD
                                                        NUMBER</span>
                                                <h6 class="m-0 mt-1">xxxx xxxx xxxx 5050</h6>
                                            </div>
                                            <div class="col-8"><span class="small letter-spacing-2">NAME OF
                                                        CARD</span>
                                                <h6 class="m-0 mt-1">Nancy Bayers</h6>
                                            </div>
                                            <div class="col-4"><span class="small letter-spacing-2">VALIDITY</span>
                                                <h6 class="m-0 mt-1">xx / xx</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-footer d-flex p-3"><a class="link-mode text-uppercase fw-500"
                                                                           href="#">Edit </a><a class="link-danger text-uppercase fw-500 ms-auto"
                                                                                                href="#">Remove</a></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header py-3 d-flex align-items-center">
                                        <h6 class="m-0">Master
                                            Card</h6><span class="ms-auto"><img width="40"
                                                                                src="../../assets/img/flags/card-master.png" title="" alt=""></span>
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-12"><span class="small letter-spacing-2">CARD
                                                        NUMBER</span>
                                                <h6 class="m-0 mt-1">xxxx xxxx xxxx 5050</h6>
                                            </div>
                                            <div class="col-8"><span class="small letter-spacing-2">NAME OF
                                                        CARD</span>
                                                <h6 class="m-0 mt-1">Nancy Bayers</h6>
                                            </div>
                                            <div class="col-4"><span class="small letter-spacing-2">VALIDITY</span>
                                                <h6 class="m-0 mt-1">xx / xx</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-footer d-flex p-3"><a class="link-mode text-uppercase fw-500"
                                                                           href="#">Edit </a><a class="link-danger text-uppercase fw-500 ms-auto"
                                                                                                href="#">Remove</a></div>
                                </div>
                            </div>
                        </div>
                        <div class="card mt-5">
                            <div class="card-header py-3">
                                <h6 class="m-0">Add New Address</h6>
                            </div>
                            <div class="card-body p-3">
                                <div class="row g-3">
                                    <div class="col-sm-6"><input class="form-control" type="text" id="cc-number_1"
                                                                 data-format="card" placeholder="Card number"></div>
                                    <div class="col-sm-6"><input class="form-control" type="text" id="cc-number"
                                                                 data-format="card" placeholder="Your Name"></div>
                                    <div class="col-sm-6">
                                        <div class="row">
                                            <div class="col-7 form-group"><input class="form-control" type="text"
                                                                                 id="cc-expiry" data-format="date" placeholder="Expiry Date">
                                            </div>
                                            <div class="col-5 form-group"><input class="form-control"
                                                                                 type="password" id="cc-cvc" data-format="cvc" placeholder="CVC">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <button class="btn btn-primary d-block w-100" type="submit">Register this
                                            card
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End Content -->
                </div>
            </div>
        </div>
    </main>
    <!-- End Main -->
    <!-- Footer -->
    <footer th:replace="frontend/component/footer :: footer"></footer>
    <!-- End Footer -->
</div>
<!--
========================
   End Wrapper
========================
-->
<!-- script start -->
<th:block th:insert="~{frontend/component/plugin/frontendplugin.html :: js}"></th:block>
<!-- End script start -->
</body>

<script>

    $(function () {

        let baseUrl = window.location.protocol + "//" + window.location.host;
        let apiPath = "/backend/rentalorder";
        let memNo = 1;

        function getAll() {

            fetch(baseUrl + apiPath + "/getFromCart?memNo=" + memNo)
                .then(function (response) {
                    return response.json();
                }).then(function (data) {

                const container = $("div#cartItemsContainer");
                container.empty();  // 清除先前的内容

                let totalItems = Object.keys(data).length; // 計算購物車商品數量
                $("span[data-cart-items]").attr("data-cart-items", totalItems); // 更新購物車商品數量圖示
                // console.log(data);
                // console.log(Object.entries(data));
                /* 遍歷陣列裡每個元素，每個元素都是一對 key, item，以下舉例
                 *
                 * [陣列1, 陣列2]
                 * 陣列1 => ["member : 1 : cartItem : 5011", {rentalCatNo : "5", rentalColor : "深卡其色"...}]
                */
                Object.entries(data).forEach(([key, item]) => {

                    let rentalSize = "";
                    switch (item.rentalSize) { // 把 size 數字換成對應英文
                        case "0" :
                            rentalSize = "XS"
                            break;
                        case "1" :
                            rentalSize = "S"
                            break;
                        case "2" :
                            rentalSize = "M"
                            break;
                        case "3" :
                            rentalSize = "L"
                            break;
                        case "4" :
                            rentalSize = "XL"
                            break;
                        case "5" :
                            rentalSize = "2L"
                            break;
                    }

                    // 創造一個 div，並給予模板需要的 class
                    let productDiv = $("<div>", {
                        "class" : "d-flex align-items-center flex-row w-100 pb-3 mb-3 border-bottom cartItem",
                        "data-rentalNo" : item.rentalNo
                    });
                    let link = $("<a>" , {
                        "class" : "d-inline-block flex-shrink-0 me-3",
                        "href" : "#"
                    }).appendTo(productDiv);
                    let img = $("<img>", {
                        "src" : "../../assets/img/fashion2/product-1.jpg",
                        "width" : "120",
                        "alt" : "Product"
                    }).appendTo(link);
                    let infoDiv = $("<div>", {
                        "class" : "d-flex flex-column flex-sm-row col"
                    }).appendTo(productDiv);
                    let detailsDiv = $("<div>", {
                        "class" : "pe-sm-2"
                    }).appendTo(infoDiv);
                    let title = $("<h3>", {
                        "class" : "product-title fs-5 mb-1"
                    }).appendTo(detailsDiv);
                    let titleLink = $("<a>", {
                        "class" : "",
                        "href" : "#",
                        "text" : item.rentalName
                    }).appendTo(title);
                    let sizeDiv = $("<div>", {
                        "class" : "small",
                        "html" : "<span class=\"text-muted me-2\">尺寸 :</span>" + rentalSize
                    }).appendTo(detailsDiv);
                    let colorDiv = $("<div>", {
                        "class" : "small",
                        "html" : "<span class=\"text-muted me-2\">顏色 :</span>" + item.rentalColor
                    }).appendTo(detailsDiv);
                    let priceDiv = $("<div>", {
                        "class" : "lead pt-1",
                        "text" : item.rentalPrice
                    }).appendTo(detailsDiv);
                    // 114
                    let actionDiv = $("<div>", {
                        "class": "pt-2 pt-sm-0 d-flex d-sm-block ms-sm-auto"
                    }).appendTo(infoDiv);

                    let qtyLabel = $("<label>", {
                        "class": "form-label d-none d-sm-inline-block",
                        "text": "數量"
                    }).appendTo(actionDiv);

                    let qtyDiv = $("<div>", {
                        "class": "cart-qty-01"
                    }).appendTo(actionDiv);

                    let decBtn = $("<div>", {
                        "class": "dec qty-btn qty_btn",
                        "html": "<i class='bi bi-caret-up-fill'></i>"
                    }).appendTo(qtyDiv);

                    let qtyInput = $("<input>", {
                        "class": "cart-qty-input form-control",
                        "type": "text",
                        "name": "qtybutton",
                        "value": "1"
                    }).appendTo(qtyDiv);

                    let incBtn = $("<div>", {
                        "class": "inc qty-btn qty_btn",
                        "html": "<i class='bi bi-caret-down-fill'></i>"
                    }).appendTo(qtyDiv);

                    let removeBtn = $("<button>", {
                        "class": "btn btn-link px-0 text-danger ms-auto",
                        "type": "button",
                        "html": "<i class='bi-trash3 me-2 delItem'></i><span class='delItem'>移除</span>"
                    }).appendTo(actionDiv);

                    container.append(productDiv);

                });

            });

        } // getAll()結束
        getAll();

    }); // DOMContentLoaded結束

</script>

</html>