<!doctype html>
<html lang="zxx">

<head>
    <!-- metas -->
    <meta charset="utf-8">
    <meta name="author" content="pxdraft">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="keywords" content="ShopApp - eCommerce Bootstrap 5 Template">
    <meta name="description" content="ShopApp - eCommerce Bootstrap 5 Template">
    <!-- title -->
    <title>租借品專區</title>
    <!-- Favicon -->
    <link rel="shortcut icon" th:href="@{/logo/favicon.ico}">
    <!-- CSS Template -->
    <link th:href="@{/frontend/assets/css/style.css}" rel="stylesheet">
    <style>
        span.successMsg {
            /* 確保初始狀態為隱藏，以便fadeIn能正常工作 */
            display: none;
        }
    </style>
</head>
<body>
<!-- 通用插件 -->
<th:block th:replace="frontend/component/plugin/frontendplugin :: components"></th:block>
<!-- 通用插件 -->
<!--
========================
    Wrapper
========================
-->
<div class="wrapper">
    <!-- header height -->
    <div class="header-height-bar" style="min-height: 144.865px;"></div>
    <!-- Header -->
    <header th:replace="frontend/component/header :: header"></header>
    <!-- End Header -->
    <!-- Main -->
    <main>
        <!-- 租借品專區 -->
        <div class="py-3 bg-gray-100">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-6 my-2">
                        <h1 class="m-0 h4 text-center text-lg-start">租借品專區</h1>
                    </div>
                    <div class="col-lg-6 my-2">
                        <ol class="breadcrumb m-0 small justify-content-center justify-content-lg-end">
                            <li class="breadcrumb-item">
                                <a class="text-nowrap text-reset" th:href="@{/frontend/index}">Home</a>
                            </li>
                            <li class="breadcrumb-item text-nowrap active" aria-current="page">租借品</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Breadcrumb -->
        <!-- Shop -->
        <section class="py-6">
            <div class="container">
                <div class="row">
                    <!-- Sidebar -->
                    <div class="col-lg-4 col-xl-3 pe-xl-5 offcanvas-lg offcanvas-start px-0 px-lg-3" tabindex="-1"
                         id="shop_filter" aria-labelledby="shop_filterLabel">
                        <div class="offcanvas-header border-bottom">
                            <h5 class="offcanvas-title" id="shop_filterLabel">Shop Filter</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
                                    data-bs-target="#shop_filter" aria-label="Close"></button>
                        </div>
                        <div class="offcanvas-body flex-column">
                            <!-- Categories -->
                            <div class="shop-sidebar-block">
                                <div class="shop-sidebar-title">
                                    <a class="h5" data-bs-toggle="collapse" href="#shop_categories" role="button"
                                       aria-expanded="true" aria-controls="shop_categories">
                                        租借品類別 <i class="bi bi-chevron-up"></i>
                                    </a>
                                </div>
                                <div class="shop-category-list collapse show" id="shop_categories">
                                    <ul class="nav flex-column">
                                        <li class="nav-item">
                                            <a th:href="@{/frontend/rental/rentalShop}" class="nav-link active">所有租借品</a>
                                        </li>

                                        <li class="nav-item">
                                            <a href="#" class="nav-link">男士 <span>(25)</span>
                                            </a>
                                            <a data-bs-toggle="collapse" href="#shop_cat_1" role="button"
                                               aria-expanded="false" aria-controls="shop_cat_1" class="s-icon"></a>
                                            <div class="collapse" id="shop_cat_1">
                                                <ul class="nav nav-pills flex-column nav-hierarchy">
                                                    <li class="nav-item">
                                                        <a th:href="@{'/frontend/rentalcategory/showOneRentalCat?rentalCatNo=1'}" class="nav-link">西裝</a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a th:href="@{'/frontend/rentalcategory/showOneRentalCat?rentalCatNo=1'}" class="nav-link">襯衫</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </li>
                                        <li class="nav-item">
                                            <a href="#" class="nav-link">女士 <span>(40)</span>
                                            </a>
                                            <a data-bs-toggle="collapse" href="#shop_cat_2" role="button"
                                               aria-expanded="false" aria-controls="shop_cat_2" class="s-icon"></a>
                                            <div class="collapse" id="shop_cat_2">
                                                <ul class="nav nav-pills flex-column nav-hierarchy">
                                                    <li class="nav-item">
                                                        <a th:href="@{'/frontend/rentalcategory/showOneRentalCat?rentalCatNo=2'}" class="nav-link">婚紗</a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a th:href="@{'/frontend/rentalcategory/showOneRentalCat?rentalCatNo=3'}" class="nav-link">禮服</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <!-- 顏色 -->
                            <div class="shop-sidebar-block">
                                <div class="shop-sidebar-block">
                                    <div class="shop-sidebar-title">
                                        <a class="h5" data-bs-toggle="collapse" href="#shop_Color" role="button"
                                           aria-expanded="true" aria-controls="shop_Color">
                                            顏色 <i class="bi bi-chevron-up"></i>
                                        </a>
                                    </div>
                                    <div class="shop-sidebar-list collapse show" id="shop_Color">
                                        <ul>
                                            <li class="custom-checkbox">
                                                <input class="custom-control-input" id="colorsidebar1" type="checkbox" value="藍色">
                                                <label class="custom-control-label" for="colorsidebar1">
                                                    <span class="text-body">藍色</span>
                                                </label>
                                            </li>
                                            <li class="custom-checkbox">
                                                <input class="custom-control-input" id="colorsidebar2" type="checkbox" value="白色">
                                                <label class="custom-control-label" for="colorsidebar2">
                                                    <span class="text-body">白色</span>
                                                </label>
                                            </li>
                                            <li class="custom-checkbox">
                                                <input class="custom-control-input" id="colorsidebar3" type="checkbox" value="黑色">
                                                <label class="custom-control-label" for="colorsidebar3">
                                                    <span class="text-body">黑色</span>
                                                </label>
                                            </li>
                                            <li class="custom-checkbox">
                                                <input class="custom-control-input" id="colorsidebar4" type="checkbox" value="紅色">
                                                <label class="custom-control-label" for="colorsidebar4">
                                                    <span class="text-body">紅色</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <!-- End Color -->
                            <!-- 大小size -->
                            <div class="shop-sidebar-block">
                                <div class="shop-sidebar-title">
                                    <a class="h5" data-bs-toggle="collapse" href="#shop_brand" role="button"
                                       aria-expanded="true" aria-controls="shop_brand">
                                        尺寸 <i class="bi bi-chevron-up"></i>
                                    </a>
                                </div>
                                <div class="shop-sidebar-list collapse show" id="shop_brand">
                                    <ul>
                                        <li class="custom-checkbox">
                                            <input class="custom-control-input" id="brand1" type="checkbox">
                                            <label class="custom-control-label" for="brand1">XS</label>
                                        </li>
                                        <li class="custom-checkbox">
                                            <input class="custom-control-input" id="brand2" type="checkbox">
                                            <label class="custom-control-label" for="brand2">S</label>
                                        </li>
                                        <li class="custom-checkbox">
                                            <input class="custom-control-input" id="brand3" type="checkbox">
                                            <label class="custom-control-label" for="brand3">M</label>
                                        </li>
                                        <li class="custom-checkbox">
                                            <input class="custom-control-input" id="brand4" type="checkbox">
                                            <label class="custom-control-label" for="brand4">L</label>
                                        </li>
                                        <li class="custom-checkbox">
                                            <input class="custom-control-input" id="brand5" type="checkbox">
                                            <label class="custom-control-label" for="brand5">XL</label>
                                        </li>
                                        <li class="custom-checkbox">
                                            <input class="custom-control-input" id="brand6" type="checkbox">
                                            <label class="custom-control-label" for="brand6">2L</label>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <!-- End Brands -->
                            <!-- 租借金額 -->
                            <div class="shop-sidebar-block">
                                <div class="shop-sidebar-title">
                                    <a class="h5" data-bs-toggle="collapse" href="#shop_price" role="button"
                                       aria-expanded="true" aria-controls="shop_price">
                                        租借金額 <i class="bi bi-chevron-up"></i>
                                    </a>
                                </div>
                                <div class="shop-sidebar-list collapse show" id="shop_price">
                                    <ul>
                                        <li class="custom-checkbox">
                                            <input class="custom-control-input" id="price1" type="checkbox">
                                            <label class="custom-control-label" for="price1">$2000</label>
                                        </li>
                                        <li class="custom-checkbox">
                                            <input class="custom-control-input" id="price2" type="checkbox">
                                            <label class="custom-control-label" for="price2">$4000</label>
                                        </li>
                                    </ul>
                                </div>
                            </div><!-- End Brands -->
                        </div><!-- <div class="offcanvas-body flex-column">  -->
                    </div>
                    <!-- End Sidebar -->
                    <!-- 商品列表 -->
                    <div class="col-lg-8 col-xl-9">
                        <div class="shop-top-bar d-flex pb-3"><!-- 切換顯示&排序的區塊 -->
                            <!-- 列表呈現方式 (網格or直列) -->
                            <div class="layout-change">
                                <!-- 手機模式  Mobile Toggle -->
                                <button class="btn btn-sm d-lg-none" type="button" data-bs-toggle="offcanvas"
                                        data-bs-target="#shop_filter" aria-controls="shop_filter">
                                    <i class="fs-4 lh-1 bi bi-justify-left"></i>
                                </button>
                                <!-- 手機模式 結束 Mobile Toggle -->
                                <a class="btn btn-white btn-sm" th:href="@{/frontend/rental/rentalShopGrid}">
                                    <i class="bi bi-grid"></i>
                                </a>
                                <a class="btn btn-white btn-sm active" th:href="@{/frontend/rental/rentalShop}">
                                    <i class="bi bi-view-stacked"></i>
                                </a>
                            </div>
                            <!-- 列表呈現方式 (網格or直列)  結束 -->
                            <!--  選擇排序   -->
                            <div class="shortby-dropdown ms-auto" id="sortAllPrice">
                                <div class="dropdown">
                                    <a class="btn btn-none btn-sm border dropdown-toggle text-mode" href="#"
                                       role="button" id="dropdownMenuLink" data-bs-toggle="dropdown"
                                       aria-expanded="false">選擇排序</a>
                                    <ul class="dropdown-menu dropdown-menu-end shadow"
                                        aria-labelledby="dropdownMenuLink">
                                        <li>
                                            <a class="sort-item" data-sort="newest" th:href="@{/frontend/rental/rentalShop/{sortType}}">最新</a>
                                        </li>
                                        <li>
                                            <a class="sort-item" data-sort="low_to_high" th:href="@{/frontend/rental/rentalShop/{sortType}}">價格由低到高</a>
                                        </li>
                                        <li>
                                            <a class="sort-item" data-sort="high_to_low"  th:href="@{/frontend/rental/rentalShop/{sortType}}">價格由高到低</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- 商品 -->
                        <div id="rental-list">
                        <th:block th:each="rental : ${rentalListData}">
                            <div class="row g-0 mb-4 rental">
                                <div class="col-sm-4 position-relative">
                                    <div class="badge-ribbon position-absolute top-0 mt-3">
                                        <span class="badge bg-danger">Sale</span>
                                    </div>
                                <a th:href="@{'/frontend/rental/showOneRental?rentalNo=' + ${rental.rentalNo}}"><!-- 對應品項查詢 -->
                                    <img class="border img-fluid w-100 rentalShopPic" th:src="@{'/icons/frontend/rental/rentalshop/' + ${rental.rentalNo} + '.jpg'}"
                                         th:width="276" th:height="310" title="" alt="">
                                </a>
                                </div>
                                <div class="col-sm-8 ps-sm-4 pt-3 pt-sm-0" style="transform: translate3d(0px, 20px, 0px);">
                                    <div class="rating-star text mb-2 small"><!-- 評價 -->
                                        <i class="bi bi-star-fill active"></i>
                                        <i class="bi bi-star-fill active"></i>
                                        <i class="bi bi-star-fill active"></i>
                                        <i class="bi bi-star-fill active"></i>
                                        <i class="bi bi-star"></i>
                                    </div>
                                    <h5 class="product-title">
                                        <a class="text-reset" th:href="@{'/frontend/rental/showOneRental?rentalNo=' + ${rental.rentalNo}}">
                                            <span th:text="${rental.rentalName}"></span></a><!-- 租借品名稱 -->
                                    </h5>
                                    <div class="m-0">
                                        <p class="small mb-2"><span>編號：</span><span class="rentalNo" th:text="${rental.rentalNo}"></span></p><!-- 租借品編號 -->
                                        <p class="small mb-2"><span th:text="${rental.rentalInfo}"></span></p><!-- 租借品介紹 -->
                                    </div>
                                    <div class="product-price pb-3">
                                        <span class="text-primary fs-4" th:text="'$' + ${rental.rentalCategory.rentalDesPrice}"></span><!-- 押金 -->
                                        <del class="fs-sm text-muted"><span th:text="'$' + ${rental.rentalPrice}"></span></del><!-- 定價 -->
                                    </div>
                                    <div>
                                        <a href="" class="btn btn-mode btn_addToCart"><!--  加入購物車(457)  -->
                                            <i class="fi-shopping-cart"></i>
                                        </a>
                                        <a href="" class="btn btn-primary btn_addToFAV"><!--  加入我的最愛  -->
                                            <i class="fi-heart"></i>
                                        </a>
                                        <a href="#" class="btn btn-primary btn_addTrack">
                                            <i class="bi bi-bookmark"></i>
                                        </a>
<!--                                        <a data-bs-toggle="modal" data-bs-target="#px-quick-view" th:href="@{/frontend/rental/rentalQuickview}"-->
<!--                                           href="javascript:void(0)" class="btn btn-primary">-->
<!--                                            <i class="fi-eye"></i>&lt;!&ndash;  跳窗顯示該商品畫面 (rentalQuickview.html) &ndash;&gt;-->
<!--                                        </a>-->
                                        <span class="successMsg" style="color: lightgreen"></span>
                                    </div>
                                </div>
                            </div>
                        </th:block>
                        </div>
                        <!-- 商品  結束 -->
                        <!-- 分頁區  -->
                        <div class="shop-bottom-bar d-flex align-items-center mt-3">
                            <div>Showing: 1 - 12 of 17</div>
                            <div class="ms-auto">
                                <ul class="pagination">
                                    <li class="page-item">
                                        <a class="page-link" href="#" aria-label="Previous">
                                            <span aria-hidden="true">&laquo;</span>
                                        </a>
                                    </li>
                                    <li class="page-item active">
                                        <a class="page-link" href="#">1</a>
                                    </li>
                                    <li class="page-item">
                                        <a class="page-link" href="#">2</a>
                                    </li>
                                    <li class="page-item">
                                        <a class="page-link" href="#">3</a>
                                    </li>
                                    <li class="page-item">
                                        <a class="page-link" href="#" aria-label="Next">
                                            <span aria-hidden="true">&raquo;</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div><!-- 分頁區  結束  -->
                    </div><!--   <div class="col-lg-8 col-xl-9">-->
                    <!-- 商品列表結束 -->
                </div>
            </div>
        </section>
        <!-- End Shop -->
    </main>
    <!-- End Main -->
    <!-- Footer -->
    <footer th:replace="frontend/component/footer :: footer"></footer>
    <!-- End Footer -->
</div>
<!--
========================
   End Wrapper
========================
-->
<!-- script start -->
<th:block th:insert="~{frontend/component/plugin/frontendplugin.html :: js}"></th:block>
<!-- End script start -->

<script>
    /*
     * 選擇對應顏色
     * 使用jQuery抓取點擊事件，前台發送清求。
     * 最後依後台判斷選擇方式並回傳對應的資料。
    */
    $(document).ready(function() {
        $('input[type="checkbox"]').change(function() {
            // 收集已選中的顏色值
            const selectedColors = [];
            $('input[type="checkbox"]:checked').each(function() {
                selectedColors.push($(this).val());
            });

            // 發送 AJAX 請求到後端
            $.ajax({
                url: '/getDisplayColor',
                type: 'GET',
                data: { color: selectedColors.join(',') }, // 傳遞選中的顏色值作為參數
                success: function(data) {
                    // 更新頁面上的商品列表
                    updateProductList(data);
                },
                error: function(xhr, status, error) {
                    console.error('Error:', error);
                }
            });
        });

        // 更新頁面上的商品列表
        function updateProductList(rentals) {
            // 清空原有的商品列表
            $('#product-list').empty();

            // 循環添加新的商品信息
            rentals.forEach(function(rental) {
                $('#product-list').append('<div>' + rental.rentalName + ' - ' + rental.rentalColor + '</div>');
            });
        }
    });


    /*
     * 選擇排序方式
     * 使用jQuery抓取點擊事件，前台發送清求。
     * 最後依後台判斷選擇方式並回傳對應的資料。
    */
    $(document).ready(function() {
        $('.sort-item').click(function(event) {
            event.preventDefault();
            let sortType = $(this).data('sort');

            let url = "/frontend/rental/rentalShop/" + sortType;

            window.location.href = url;  //重定向到指定頁面
        });
    });

    /*
     * 功能：點選加入我的最愛
     * 使用 th:attr 設置data-屬性，在點擊愛心後抓取到自訂的值&當下時間(ISO 8601 )
     * 前端傳遞數據至後端，後台針對時間轉Timestamp型態
    */
    $(document).on("click", "a.btn_addToFAV", function(e) {
        e.preventDefault(); // 阻止表單默認提交行為

        // window.location.protocol -> 返回當前頁面使用的協議
        // window.location.host -> 返回當前頁面的主機名和埠號
        // const baseUrl -> 將window.location.protocol和window.location.host，用 "//" 連接，取得當前頁面的URL
        const baseUrl = window.location.protocol + "//" + window.location.host;
        const rentalNo = $(this).closest("div.rental").find("span.rentalNo").text().trim();
        const rentalFavTime = new Date().toISOString(); //取得當前時間(ISO 8601型態 ，只能在後端轉型)
        console.log("抓取編號:" + rentalNo);
        console.log("抓取當前時間:" + rentalFavTime);

        //打包數據
        const wishData = {
            rentalNo: rentalNo,
            rentalFavTime: rentalFavTime
        };

        fetch(baseUrl + "/frontend/rentalmyfavorite/addWish", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(wishData) //將包裝的數據轉換成JSON格式並發送
        }).then(response => response.text())
            .then(rentalName => {
                // console.log("2 抓取打包數據:" + JSON.stringify(wishData)); //成功匯出
                console.log(rentalName + "已加入我的最愛");
            });
    });

    /*
     * 功能：顏色篩選及時更新
     *
     *
    */
    $(document).ready(function() {
        $('input[type="checkbox"]').change(function() {
            var selectedColors = [];
            $('input[type="checkbox"]:checked').each(function() {
                selectedColors.push($(this).val());
            });
            $.ajax({
                type: 'POST',
                url: '/selectColors',
                contentType: 'application/json',
                data: JSON.stringify({ selectedColors: selectedColors }),
                success: function(data) {
                    $('#results').empty();
                    data.forEach(function(item) {
                        $('#results').append('<li>' + item + '</li>');
                    });
                }
            });
        });
    });

    /*----------------------------右翰寫的方法----------------------------------*/

    $(function () {

        let baseUrl = window.location.protocol + "//" + window.location.host;
        let rentalAllPrice = 0;
        let rentalAllDepPrice = 0;

        function getAll() {

            // items.length = 0;
            rentalAllPrice = 0;
            rentalAllDepPrice = 0;
            let apiPath = "/frontend/rentalorder/";

            fetch(baseUrl + apiPath + "getFromCart")
                .then(function (response) {
                    return response.json();
                }).then(function (data) {
                    if (data === "/frontend/member/loginMember") {
                        window.location.href = data;
                    }
                let itemContainer = $("ul.list-unstyled");
                // console.log(itemContainer);
                // 每次更新前清空，放購物車資訊的 ul
                itemContainer.empty();

                let totalItems = Object.keys(data).length; // 計算購物車商品數量
                $("span[data-cart-items]").attr("data-cart-items", totalItems); // 更新購物車商品數量圖示

                /*
                 * 遍歷陣列裡每個元素，每個元素都是一對 key, item，以下舉例 :
                 * [陣列1, 陣列2]
                 * 陣列1 => ["member : 1 : cartItem : 5011", {rentalCatNo : "5", rentalColor : "深卡其色"...}]
                */
                Object.entries(data).forEach(([key, item]) => {

                    // if (item.rentalStat === "0") {
                    //     items.push(item.rentalNo);
                    // }

                    // 拼接首頁購物車區塊小明細
                    if (item.rentalStat === "0") {

                        let cartItem = $("<li>", {
                            "class" : "py-2"
                        }).appendTo(itemContainer);
                        let firstDiv = $("<div>", {
                            "class" : "row align-items-center"
                        }).appendTo(cartItem);
                        let aDiv = $("<div>", {
                            "class" : "col-4"
                        }).appendTo(firstDiv);
                        let aForItemImage = $("<a>", {
                            "href" : "#"
                        }).appendTo(aDiv);
                        let itemImage = $("<img>", {
                            "class" : "img-fluid border",
                            "th:src" : "@{/frontend/assets/img/fashion/product-x-1.jpg}",
                            "alt" : "..."
                        }).appendTo(aForItemImage);
                        let divForInfo = $("<div>", {
                            "class" : "col-8"
                        }).appendTo(firstDiv);


                        /*
                         <ul class="list-unstyled m-0 p-0">
                            <li class="py-2">
                                <div class="row align-items-center">
                                    <div class="col-4"> adiv
                                        <!-- Image -->
                                        <a href="#"> aForItemImage
                                            <img class="img-fluid border" th:src="@{/frontend/assets/img/fashion/product-x-1.jpg}" alt="...">
                                        </a>
                                    </div>
                                    <div class="col-8"> divForInfo
                                        <!-- Title -->
                                        <p class="mb-2">
                                            <a class="text-mode fw-500" href="#">這裡是品名</a>
                                            <span class="m-0 text-muted w-100 d-block">這裡是價格</span>
                                        </p>
                                        <!--Footer -->
                                        <div class="d-flex align-items-center">
                                            <!-- Remove -->
                                            <a class="small text-mode ms-auto" href="#!">
                                                <i class="bi bi-x"></i> Remove
                                            </a>
                                        </div>
                                    </div> // div col-8 結束
                                </div>
                            </li>
                         */

                        rentalAllPrice += parseFloat(item.rentalPrice);
                        rentalAllDepPrice += parseFloat(item.rentalDesPrice);

                    }

                });

                // console.log(items);
                $("span.rentalAllPrice").text(rentalAllPrice);
                $("span.rentalAllDepPrice").text(rentalAllDepPrice);
                $("span.totalPrice").text( (rentalAllPrice + rentalAllDepPrice) );

            });

        } // getAll()結束
        // 進來頁面就先取一次
        getAll();

        // 加入購物車 339
        $(document).on("click", "a.btn_addToCart", function (e) {

            e.preventDefault();
            /*
             * 拼接動態前置路徑 (為適應上雲時路徑變化)
             * window.location.protocol = 當前頁面所使用之通訊協定 (ex : http: 、 https:)
             * window.location.host = 當前頁面主機名和連接阜號 (ex : localhost:8080)
            */
            let apiPath = "/frontend/rentalorder/setToCart";
            let $this = $(this);
            // span.rentalNo
            let rentalNo = $this.closest("div.rental").find("span.rentalNo").text().trim();
            let data = {
                "rentalNo" : rentalNo
            };

            fetch(baseUrl + apiPath, {
                method : "POST",
                headers : {
                    "Content-Type" : "application/json"
                },
                body : JSON.stringify(data)
            }).then(function (response) {
                return response.text();
            }).then(function (rentalName) {
                if (rentalName === "/frontend/member/loginMember") {
                    window.location.href = rentalName;
                }
                $this.closest("div.rental").find("span.successMsg").text("已將" + rentalName + "加入購物車!").fadeIn(0).delay(500).fadeOut(500);
            })

        }); // 加入購物車方法結束

        // 加入追蹤
        $(document).on("click", "a.btn_addTrack", function (e) {

            e.preventDefault();
            let $this = $(this);
            let apiPath = "/frontend/rentalmytrack/addTrack";
            let rentalNo = $this.closest("div.rental").find("span.rentalNo").text().trim();
            let data = {
                rentalNo : rentalNo
            };

            fetch(baseUrl + apiPath, {
                method : "POST",
                headers : {
                    "Content-Type" : "application/json"
                },
                body : JSON.stringify(data)
            }).then(response => response.text())
                .then(rentalName => {
                    if (rentalName === "/frontend/member/loginMember") {
                        window.location.href = rentalName;
                    }
                    $this.closest("div.rental").find("span.successMsg").text("已加入追蹤!").fadeIn(0).delay(500).fadeOut(500);
                });



        })


    }); // DOMContentLoaded 結束

    /*----------------------------右翰寫的方法----------------------------------*/

</script>
<script th:src="@{/jquery/jquery-3.7.1.min.js}"></script>
</body>
</html>