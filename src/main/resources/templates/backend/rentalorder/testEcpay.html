<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>綠界支付測試</title>
</head>
<body>
<button class="btn" type="button">進行綠界測試</button>

<button class="logistics" type="button">綠界物流測試</button>

<form th:action="@{/backend/rentalorder/rentalCart}" method="get">
    <button type="submit">跳轉到購物車</button>
</form>

<!-- 動態加載的表單將放在這個div中 -->
<div id="ecpayFormContainer"></div>

<script>

    // $("button.btnToCart").on("click", function () {
    //     fetch("/backend/rentalorder/rentalCart").then()
    // })


    document.querySelector("button.btn").addEventListener("click", function () {
        fetch("/backend/rentalorder/ecpayCheckout", {
            method: "POST", // 指定是POST請求
            headers: {
                "Content-Type" : "application/x-www-form-urlencoded",
                "Accept": "text/html"// 預期返回的是HTML
            }
        })
            .then(response => response.text()) // 將回應轉為text
            .then(html => {
                // 將回傳的HTML表單放到頁面中
                var formContainer = document.getElementById("ecpayFormContainer");
                console.log(formContainer);
                formContainer.innerHTML = html;
                // 自動提交表單，如果表單自帶JavaScript自動提交則不需要這行
                formContainer.querySelector('form').submit();
            })
            .catch(error => {
                console.error('Error:', error);
            });
    })



</script>

</body>
</html>
